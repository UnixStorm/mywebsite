<!DOCTYPE html>  
<html lang="tr">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<title>UNIXSTORM</title>

<style>
    body {
        margin: 0;
        padding: 0;
        height: 100vh;
        background: url("3cc68b3f22ff5463843e82b661033950.jpg") no-repeat center center fixed;
        background-size: cover;
        font-family: "Arial";
    }
    .yazi-kutu { width: 100%; text-align: center; margin-top: 28px; }
    .anaYazi { font-size: 18px; color: white; font-weight: bold; text-shadow: 0 0 6px white, 0 0 14px white; }
    .vip { color: orange; font-size: 17px; text-shadow: 0 0 6px orange, 0 0 15px orange; font-weight: bold; }
    .red { color: red; font-weight: bold; text-shadow: 0 0 6px red, 0 0 15px red; }
    .center-box {
        position: fixed; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        width: 280px; padding: 18px;
        background: rgba(0,0,0,0.78); backdrop-filter: blur(5px);
        border-radius: 12px; box-shadow: 0 0 22px rgba(0,0,0,0.65);
        text-align: center; color: white;
    }
    .center-box input {
        width: 100%; padding: 10px; margin: 6px 0;
        border-radius: 8px; border: none; outline: none; font-size: 15px;
    }
    .center-box button {
        width: 100%; padding: 10px; margin-top: 8px;
        border: none; border-radius: 8px;
        background: #006CFF; color: white; font-weight: bold; cursor: pointer;
    }
    .link-btn {
        margin-top: 8px; display: block; color: #ddd;
        cursor: pointer; text-decoration: underline; font-size: 14px;
    }
    #durum { margin-top: 10px; min-height: 22px; font-size: 14px; color: #fff; }
    #blocker {
        position: fixed; inset: 0;
        background: rgba(0,0,0,0.0);
        z-index: 9999; display: none; pointer-events: none;
    }
</style>
</head>
<body>

<div class="yazi-kutu">
    <div class="anaYazi">ğğ® ğ¬ğ¢ğ­ğ ğ–£˜ğ”ğğˆğ—ğ’ğ“ğğ‘ğŒğŸ‡¹ğŸ‡· tarafÄ±nca kurulmuÅŸtur</div>
    <div style="margin-top: 6px;">
        <span class="vip">vip_Ã¼yelerğŸ”± = </span>
        <span class="red">KAAN ZORBA & Ä°NFAZ ZORBA</span>
    </div>
</div>

<div class="center-box">

    <!-- KAYIT -->
    <div id="registerForm">
        <h3>KayÄ±t Ol</h3>
        <input type="text" id="regName" placeholder="KullanÄ±cÄ± adÄ±">
        <input type="email" id="regMail" placeholder="E-posta">
        <input type="password" id="regPass" placeholder="Åifre">
        <input type="file" id="regPhoto" accept="image/*">
        <button id="regBtn">KayÄ±t Ol</button>
        <span class="link-btn" id="toLogin">GiriÅŸ yapÄ±n</span>
        <span class="link-btn" id="toReset">Åifremi unuttum</span>
    </div>

    <!-- GÄ°RÄ°Å -->
    <div id="loginForm" style="display:none;">
        <h3>GiriÅŸ Yap</h3>
        <input type="email" id="loginMail" placeholder="E-posta">
        <input type="password" id="loginPass" placeholder="Åifre">
        <button id="loginBtn">GiriÅŸ Yap</button>
        <span class="link-btn" id="toRegisterFromLogin">KayÄ±t olmak istiyorum</span>
        <span class="link-btn" id="toResetFromLogin">Åifremi unuttum</span>
    </div>

    <!-- ÅÄ°FRE -->
    <div id="resetForm" style="display:none;">
        <h3>Åifre SÄ±fÄ±rla</h3>
        <input type="email" id="resetMail" placeholder="E-posta">
        <button id="resetBtn">SÄ±fÄ±rlama linki gÃ¶nder</button>
        <span class="link-btn" id="toLoginFromReset">GiriÅŸe dÃ¶n</span>
    </div>

    <div id="durum"></div>
</div>

<div id="blocker"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail }
from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
import { getFirestore, setDoc, getDocs, collection, query, where, doc }
from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyC5X_RnBnhy2k-X6Y_lezHgWbgK31Y5Dao",
    authDomain: "unixstorm-9dff8.firebaseapp.com",
    projectId: "unixstorm-9dff8",
    storageBucket: "unixstorm-9dff8.appspot.com",
    messagingSenderId: "787509821542",
    appId: "1:787509821542:web:2b54b5bafee1207edeada7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db   = getFirestore(app);

const durum = document.getElementById("durum");
const blocker = document.getElementById("blocker");

function blockUI(){ blocker.style.display="block"; blocker.style.pointerEvents="auto"; }
function unblockUI(){ blocker.style.display="none"; blocker.style.pointerEvents="none"; }

function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }

function toBase64(file){
  return new Promise((resolve,reject)=>{
    const reader=new FileReader();
    reader.onload=()=>resolve(reader.result);
    reader.onerror=()=>reject("Base64 hatasÄ±");
    reader.readAsDataURL(file);
  });
}

async function formDegistir(target){
  durum.textContent="Bekleyiniz...";
  blockUI();
  await sleep(1000);  /* â†“â†“â†“ bekleme sÃ¼resi kÄ±saldÄ± */
  document.getElementById("registerForm").style.display="none";
  document.getElementById("loginForm").style.display="none";
  document.getElementById("resetForm").style.display="none";
  document.getElementById(target+"Form").style.display="block";
  durum.textContent="";
  unblockUI();
}

document.getElementById("toLogin").onclick = ()=> formDegistir('login');
document.getElementById("toReset").onclick = ()=> formDegistir('reset');
document.getElementById("toRegisterFromLogin").onclick = ()=> formDegistir('register');
document.getElementById("toResetFromLogin").onclick = ()=> formDegistir('reset');
document.getElementById("toLoginFromReset").onclick = ()=> formDegistir('login');

document.getElementById("regBtn").onclick = async function(){

  const ad   = regName.value.trim();
  const mail = regMail.value.trim();
  const pass = regPass.value;
  const foto = regPhoto.files[0];

  if(!ad || !mail || !pass){ durum.textContent="LÃ¼tfen tÃ¼m alanlarÄ± doldurun."; return; }
  if(!foto){ durum.textContent="âš  Profil fotoÄŸrafÄ± zorunlu!"; return; }

  try{
    blockUI();
    durum.textContent="Kontrol...";
    await sleep(1000);

    const q = query(collection(db,"kullanicilar"), where("kullaniciAdi","==",ad));
    const sp = await getDocs(q);
    if(!sp.empty){ durum.textContent="Bu kullanÄ±cÄ± adÄ± var!"; unblockUI(); return; }

    durum.textContent="KayÄ±t yapÄ±lÄ±yor...";
    const base64Foto = await toBase64(foto);

    const cred = await createUserWithEmailAndPassword(auth,mail,pass);

    await setDoc(doc(db,"kullanicilar",cred.user.uid),{
      kullaniciAdi: ad,
      email: mail,
      photoBase64: base64Foto,
      createdAt: new Date().toISOString()
    });

    durum.textContent="âœ” BaÅŸarÄ±lÄ±, yÃ¶nlendiriliyor...";
    await sleep(2000);
    location.href="ana_site.html";

  }catch(e){
    durum.textContent="Hata: "+e.message;
    unblockUI();
  }
};

document.getElementById("loginBtn").onclick = async function(){
  const mail = loginMail.value.trim();
  const pass = loginPass.value;

  if(!mail || !pass){ durum.textContent="Eksik bilgi!"; return; }

  try{
    blockUI();
    durum.textContent="GiriÅŸ...";
    await signInWithEmailAndPassword(auth,mail,pass);
    durum.textContent="âœ” BaÅŸarÄ±lÄ±!";
    await sleep(1500);
    location.href="ana_site.html";
  }catch(e){
    durum.textContent="Hata: "+e.message;
    unblockUI();
  }
};

document.getElementById("resetBtn").onclick = async function(){
  const mail = resetMail.value.trim();
  if(!mail){ durum.textContent="E-posta girin."; return; }

  try{
    blockUI();
    durum.textContent="Kontrol...";
    await sleep(1000);

    const q=query(collection(db,"kullanicilar"), where("email","==",mail));
    const sp=await getDocs(q);
    if(sp.empty){ durum.textContent="E-posta yok."; unblockUI(); return; }

    await sendPasswordResetEmail(auth,mail);
    durum.textContent="âœ” GÃ¶nderildi!";
    await sleep(2000);
    unblockUI();

  }catch(e){
    durum.textContent="Hata: "+e.message;
    unblockUI();
  }
};

unblockUI();
</script>

</body>
</html>
