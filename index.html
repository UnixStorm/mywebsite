<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UNIXSTORM</title>

<style>
    body {
        margin: 0;
        padding: 0;
        height: 100vh;
        background: url("3cc68b3f22ff5463843e82b661033950.jpg") no-repeat center center fixed;
        background-size: cover;
        font-family: "Arial";
    }
    .yazi-kutu { width: 100%; text-align: center; margin-top: 28px; }
    .anaYazi {
        font-size: 18px;
        color: white;
        font-weight: bold;
        text-shadow: 0 0 6px white, 0 0 14px white;
    }
    .vip {
        color: orange;
        font-size: 17px;
        text-shadow: 0 0 6px orange, 0 0 15px orange;
        font-weight: bold;
    }
    .red {
        color: red;
        font-weight: bold;
        text-shadow: 0 0 6px red, 0 0 15px red;
    }

    .center-box {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 280px;
        padding: 18px;
        background: rgba(0,0,0,0.78);
        backdrop-filter: blur(5px);
        border-radius: 12px;
        box-shadow: 0 0 22px rgba(0,0,0,0.65);
        text-align: center;
        color: white;
    }
    .center-box h3 { margin: 0 0 12px 0; font-size: 22px; }
    .center-box input {
        width: 100%;
        padding: 10px;
        margin: 6px 0;
        border-radius: 8px;
        border: none;
        outline: none;
        box-sizing: border-box;
        font-size: 15px;
    }
    .center-box button {
        width: 100%;
        padding: 10px;
        margin-top: 8px;
        border: none;
        border-radius: 8px;
        background: #006CFF;
        color: white;
        font-weight: bold;
        cursor: pointer;
        font-size: 16px;
    }
    .link-btn {
        margin-top: 8px;
        display: block;
        color: #ddd;
        cursor: pointer;
        text-decoration: underline;
        font-size: 14px;
    }
    #durum {
        margin-top: 10px;
        font-size: 14px;
        min-height: 22px;
        color: #fff;
    }

    /* SAYFA KÄ°LÄ°TLEME - gÃ¶rÃ¼nmez overlay, tÄ±klamalarÄ± engeller */
    #kilit {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        z-index: 9999;
        display: none;
        pointer-events: auto;
    }

</style>
</head>
<body>

<div id="kilit" aria-hidden="true"></div>

<div class="yazi-kutu">
    <div class="anaYazi">ğğ® ğ¬ğ¢ğ­ğ ğ–£˜ğ”ğğˆğ—ğ’ğ“ğğ‘ğŒğŸ‡¹ğŸ‡· á´›á´€Ê€á´€Ò“Ä±É´á´…á´€É´ á´‹á´œÊ€á´œÊŸá´á´œsÌ§á´›á´œÊ€</div>
    <div style="margin-top: 6px;">
        <span class="vip">ğ˜ƒğ—¶ğ—½_ğ˜‚ğ˜†ğ—²ğ—¹ğ—²ğ—¿ğŸ”± = </span>
        <span class="red">ğŠğ€ğ€ğ ğ™ğğ‘ğğ€ & ğˆğğ…ğ€ğ™ ğ™ğğ‘ğğ€</span>
    </div>
</div>

<div class="center-box">

    <div id="registerForm">
        <h3>KayÄ±t Ol</h3>
        <input type="text" id="regName" placeholder="KullanÄ±cÄ± adÄ±">
        <input type="email" id="regMail" placeholder="E-posta">
        <input type="password" id="regPass" placeholder="Åifre">
        <button id="regBtn">KayÄ±t Ol</button>

        <span class="link-btn" id="toLogin">GiriÅŸ yapÄ±n</span>
        <span class="link-btn" id="toReset">Åifremi unuttum</span>
    </div>

    <div id="loginForm" style="display:none;">
        <h3>GiriÅŸ Yap</h3>
        <input type="email" id="loginMail" placeholder="E-posta">
        <input type="password" id="loginPass" placeholder="Åifre">
        <button id="loginBtn">GiriÅŸ Yap</button>

        <span class="link-btn" id="toRegisterFromLogin">KayÄ±t olmak istiyorum</span>
        <span class="link-btn" id="toResetFromLogin">Åifremi unuttum</span>
    </div>

    <div id="resetForm" style="display:none;">
        <h3>Åifre SÄ±fÄ±rla</h3>
        <input type="email" id="resetMail" placeholder="E-posta">
        <button id="resetBtn">SÄ±fÄ±rlama linki gÃ¶nder</button>

        <span class="link-btn" id="toLoginFromReset">GiriÅŸe dÃ¶n</span>
    </div>

    <div id="durum"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

import {
  getFirestore,
  setDoc,
  getDocs,
  collection,
  query,
  where,
  doc
} from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

/* --- FIREBASE CONFIG --- (senin configin korunuyor) */
const firebaseConfig = {
    apiKey: "AIzaSyC5X_RnBnhy2k-X6Y_lezHgWbgK31Y5Dao",
    authDomain: "unixstorm-9dff8.firebaseapp.com",
    projectId: "unixstorm-9dff8",
    storageBucket: "unixstorm-9dff8.appspot.com",
    messagingSenderId: "787509821542",
    appId: "1:787509821542:web:2b54b5bafee1207edeada7",
    measurementId: "G-BQYS1575QZ"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db   = getFirestore(app);

/* element referanslarÄ± */
const durum = document.getElementById("durum");
const kilit = document.getElementById("kilit");
const regNameEl = document.getElementById("regName");
const regMailEl = document.getElementById("regMail");
const regPassEl = document.getElementById("regPass");
const regBtnEl  = document.getElementById("regBtn");

const loginMailEl = document.getElementById("loginMail");
const loginPassEl = document.getElementById("loginPass");
const loginBtnEl  = document.getElementById("loginBtn");

const resetMailEl = document.getElementById("resetMail");
const resetBtnEl  = document.getElementById("resetBtn");

/* kilit fonksiyonlarÄ± */
function kilitle(){ kilit.style.display = "block"; }
function ac(){ kilit.style.display = "none"; }

/* form geÃ§iÅŸleri (mevcut davranÄ±ÅŸ korunur) */
function formDegistir(target){
    document.getElementById("registerForm").style.display="none";
    document.getElementById("loginForm").style.display="none";
    document.getElementById("resetForm").style.display="none";
    document.getElementById(target+"Form").style.display="block";
    durum.textContent = "";
}

document.getElementById("toLogin").onclick = ()=> formDegistir("login");
document.getElementById("toReset").onclick = ()=> formDegistir("reset");
document.getElementById("toRegisterFromLogin").onclick = ()=> formDegistir("register");
document.getElementById("toResetFromLogin").onclick = ()=> formDegistir("reset");
document.getElementById("toLoginFromReset").onclick = ()=> formDegistir("login");

/* ---------- KAYIT ---------- */
/* Ä°stek atÄ±lÄ±r atÄ±lmaz ekran kilitlenir (tÄ±klama engellenir). EÄŸer iÅŸlem baÅŸarÄ±sÄ±z olursa hata gÃ¶sterilir ve kilit aÃ§Ä±lÄ±r. BaÅŸarÄ±lÄ±ysa durum mesajÄ± gÃ¶sterilip yÃ¶nlendirme yapÄ±lÄ±r (kilit aÃ§Ä±k kalÄ±r). */
regBtnEl.onclick = async () => {
  const ad   = regNameEl.value.trim();
  const mail = regMailEl.value.trim();
  const pass = regPassEl.value;

  if(!ad || !mail || !pass){
    durum.textContent = "LÃ¼tfen tÃ¼m alanlarÄ± doldurun.";
    return;
  }

  try{
    kilitle();
    durum.textContent = "KayÄ±t yapÄ±lÄ±yor... lÃ¼tfen bekleyin";

    // kullanÄ±cÄ± adÄ± kontrolÃ¼
    const q = query(collection(db,"kullanicilar"), where("kullaniciAdi","==",ad));
    const sp = await getDocs(q);

    if(!sp.empty){
      ac();
      durum.textContent = "âš  Bu kullanÄ±cÄ± adÄ± zaten var!";
      return;
    }

    // firebase auth create
    const cred = await createUserWithEmailAndPassword(auth, mail, pass);

    // firestore kaydÄ±
    await setDoc(doc(db,"kullanicilar",cred.user.uid),{
      kullaniciAdi: ad,
      email: mail,
      createdAt: new Date().toISOString()
    });

    // baÅŸarÄ±lÄ± -> yÃ¶nlendir (kilit aÃ§Ä±k kalÄ±r)
    durum.textContent = "âœ” KayÄ±t baÅŸarÄ±lÄ±! YÃ¶nlendiriliyorsunuz...";
    setTimeout(()=> location.href = "ana_site.html", 1200);

  }catch(err){
    ac();
    // hata mesajÄ± kullanÄ±cÄ±ya gÃ¶ster
    durum.textContent = "Hata: " + (err && err.message ? err.message : String(err));
  }
};

/* ---------- GÄ°RÄ°Å ---------- */
loginBtnEl.onclick = async () => {
  const mail = loginMailEl.value.trim();
  const pass = loginPassEl.value;

  if(!mail || !pass){
    durum.textContent = "LÃ¼tfen bilgileri girin.";
    return;
  }

  try{
    kilitle();
    durum.textContent = "GiriÅŸ yapÄ±lÄ±yor... lÃ¼tfen bekleyin";

    await signInWithEmailAndPassword(auth, mail, pass);

    durum.textContent = "âœ” GiriÅŸ baÅŸarÄ±lÄ±! YÃ¶nlendiriliyorsunuz...";
    setTimeout(()=> location.href = "ana_site.html", 1200);

  }catch(err){
    ac();
    durum.textContent = "Hata: " + (err && err.message ? err.message : String(err));
  }
};

/* ---------- ÅÄ°FRE SIFIRLAMA ---------- */
resetBtnEl.onclick = async () => {
  const mail = resetMailEl.value.trim();

  if(!mail){
    durum.textContent = "LÃ¼tfen e-posta girin.";
    return;
  }

  try{
    kilitle();
    durum.textContent = "SÄ±fÄ±rlama isteÄŸi gÃ¶nderiliyor...";

    // eposta kayÄ±tlÄ± mÄ± kontrol et
    const q = query(collection(db,"kullanicilar"), where("email","==",mail));
    const sp = await getDocs(q);

    if(sp.empty){
      ac();
      durum.textContent = "Bu e-posta sisteme kayÄ±tlÄ± deÄŸil.";
      return;
    }

    await sendPasswordResetEmail(auth, mail);
    ac();
    durum.textContent = "âœ” SÄ±fÄ±rlama linki gÃ¶nderildi! E-postanÄ±zÄ± kontrol edin.";

  }catch(err){
    ac();
    durum.textContent = "Hata: " + (err && err.message ? err.message : String(err));
  }
};

</script>

<!-- MÃœZÄ°K BUTONU -->
<button id="musicBtn" style="
position: fixed;
bottom: 20px;
right: 20px;
padding: 12px 20px;
font-size: 18px;
border: none;
border-radius: 10px;
background: rgba(0,0,0,0.6);
color: white;
cursor: pointer;
">â–¶ Oynat</button>

<audio id="bgm">
    <source src="music.m4a" type="audio/mp4">
</audio>

<script>
const audio = document.getElementById("bgm");
const btn   = document.getElementById("musicBtn");

btn.onclick = () => {
    if(audio.paused){
        audio.play().catch(()=>{});
        btn.textContent = "â¸ Durdur";
    } else {
        audio.pause();
        btn.textContent = "â–¶ Oynat";
    }
};
</script>

</body>
    </html>
