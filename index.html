<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>UNIXSTORM</title>

<!-- Firebase SDK (modular) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.16.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendEmailVerification, sendPasswordResetEmail, signOut } from "https://www.gstatic.com/firebasejs/10.16.0/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.16.0/firebase-firestore.js";

  // --- Buraya kendi firebaseConfig koy (seninki ile deÄŸiÅŸtir) ---
  const firebaseConfig = {
    apiKey: "AIzaSyC5X_RnBnhy2k-X6Y_lezHgWbgK31Y5Dao",
    authDomain: "unixstorm-9dff8.firebaseapp.com",
    projectId: "unixstorm-9dff8",
    storageBucket: "unixstorm-9dff8.firebasestorage.app",
    messagingSenderId: "787509821542",
    appId: "1:787509821542:web:2b54b5bafee1207edeada7",
    measurementId: "G-BQYS1575QZ"
  };
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // expose to window for usage from UI handlers
  window._auth = auth;
  window._firebaseFns = {
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    sendEmailVerification,
    sendPasswordResetEmail,
    signOut,
    doc,
    setDoc
  };
</script>

<style>
  :root{
    --card-w: 360px;
    --accent: #00e6ff;
  }
  html,body{height:100%;margin:0;font-family:Inter, system-ui, Arial, sans-serif;}
  body{
    /* <-- GITHUB RAW BACKGROUND: senin repo dosya linki buraya --> */
    background-image: url('https://raw.githubusercontent.com/UnixStorm/web-sitem/main/3cc68b3f22ff5463843e82b661033950.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    display:flex;
    flex-direction:column;
    align-items:center;
    color:#fff;
  }

  /* Ãœst baÅŸlÄ±k ve vip */
  .top {
    margin-top:18px;
    text-align:center;
    z-index:10;
    pointer-events:none;
  }
  .title {
    color:#ffffff;
    font-weight:700;
    font-size:18px;
    text-shadow: 0 0 12px rgba(255,255,255,0.5);
    margin-bottom:6px;
  }
  .vip {
    font-weight:800;
    font-size:20px;
    /* yarÄ±sÄ± turuncu yarÄ±sÄ± kÄ±rmÄ±zÄ± */
    background: linear-gradient(90deg,#ffb347,#ff3d3d);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    filter: drop-shadow(0 4px 14px rgba(255,100,0,0.35));
  }

  /* Card */
  .card-wrap { width:100%; display:flex; justify-content:center; margin-top:34px; }
  .card {
    width:var(--card-w);
    max-width:92%;
    background: rgba(10,10,10,0.72);
    border-radius:16px;
    padding:22px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6), 0 0 36px rgba(0,230,255,0.16) inset;
    backdrop-filter: blur(6px);
    transition: all .45s ease;
    transform-origin:center;
  }
  .card.big { width:420px; padding:28px; }
  .card h2 { margin:0 0 10px 0; text-align:center; font-size:20px; letter-spacing:0.5px; }
  .field { margin-top:10px; }
  input[type="text"], input[type="email"], input[type="password"]{
    width:100%; padding:12px 14px; border-radius:8px; border:none; outline:none;
    font-size:15px; box-sizing:border-box;
  }
  .btn {
    margin-top:14px; width:100%; display:inline-block;
    background: linear-gradient(180deg,#1e90ff,#007bff);
    color:white; padding:12px; border-radius:8px; border:none; cursor:pointer; font-size:16px;
    box-shadow: 0 6px 20px rgba(0,123,255,0.25);
  }
  .linkrow { margin-top:12px; text-align:center; color:#d6d6d6; font-size:14px; }
  .linkrow a { color:#d6d6d6; text-decoration:underline; cursor:pointer; display:block; }
  .small { font-size:12px; color:#cfcfcf; margin-top:8px; text-align:center; }

  /* toast */
  .toast {
    position:fixed; left:50%; transform:translateX(-50%); bottom:28px; background:rgba(0,0,0,0.75);
    color:white; padding:10px 14px; border-radius:8px; display:none;
  }

  /* responsive */
  @media (max-width:420px){
    .vip{ font-size:16px;}
    .title{font-size:16px;}
  }
</style>
</head>
<body>

  <div class="top">
    <div class="title">[ğğ® ğ’ğ¢ğ­ğğ²ğ¢ ğ–£˜ğ”ğğˆÌ‡ğ—ğ’ğ“ğğ‘ğŒğŸ‡¹ğŸ‡· (ğ’ğ€ğ‡ğ) ğŠğ®ğ«ğ¦ğ®ğ¬ğ­ğ®ğ«]</div>
    <div class="vip">ğ˜ƒğ—¶ğ—½_ğ˜‚ğ˜†ğ—²ğ—¹ğ—²ğ—¿ğŸ”± = <span style="color:transparent;background:linear-gradient(90deg,#ffc65b,#ff3d3d);-webkit-background-clip:text">INFAZ ZORBA</span> and <span style="color:transparent;background:linear-gradient(90deg,#ff3d3d,#ff6060);-webkit-background-clip:text">KAAN ZORBA</span></div>
  </div>

  <div class="card-wrap">
    <div class="card" id="card">
      <h2 id="formTitle">UNIXSTORM â€” KayÄ±t Ol</h2>

      <div id="registerGroup">
        <div class="field"><input id="username" type="text" placeholder="KullanÄ±cÄ± adÄ± (her ÅŸey serbest)"></div>
        <div class="field"><input id="email" type="email" placeholder="E-posta (kod/link gÃ¶nderilecek)"></div>
      </div>

      <div class="field"><input id="password" type="password" placeholder="Åifre"></div>

      <button id="actionBtn" class="btn">KayÄ±t Ol</button>

      <div class="linkrow">
        <a id="toggleMode">HesabÄ±n var mÄ±? GiriÅŸ yap</a>
        <a id="forgotLink">Åifremi unuttum</a>
      </div>

      <div class="small" id="note">Not: KayÄ±t olunca doÄŸrulama e-postasÄ± gelecek. DoÄŸruladÄ±ktan sonra giriÅŸ yapabilirsiniz.</div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
/* ---------- UI kontrol ---------- */
const card = document.getElementById('card');
const formTitle = document.getElementById('formTitle');
const registerGroup = document.getElementById('registerGroup');
const usernameInput = document.getElementById('username');
const emailInput = document.getElementById('email');
const passwordInput = document.getElementById('password');
const actionBtn = document.getElementById('actionBtn');
const toggleModeLink = document.getElementById('toggleMode');
const forgotLink = document.getElementById('forgotLink');
const note = document.getElementById('note');
const toast = document.getElementById('toast');

let mode = 'register'; // register | login | reset

function showToast(txt, time=3000){
  toast.innerText = txt;
  toast.style.display = 'block';
  setTimeout(()=> toast.style.display='none', time);
}

/* Toggle between register and login */
toggleModeLink.addEventListener('click', (e)=>{
  e.preventDefault();
  if(mode === 'register'){
    // go login
    mode = 'login';
    formTitle.innerText = 'GiriÅŸ Yap';
    registerGroup.style.display = 'none';
    actionBtn.innerText = 'GiriÅŸ Yap';
    toggleModeLink.innerText = 'HesabÄ±n yok mu? KayÄ±t ol';
    note.style.display = 'none';
    forgotLink.style.display = 'block';
    card.classList.add('big'); // subtle size change
  } else {
    mode = 'register';
    formTitle.innerText = 'UNIXSTORM â€” KayÄ±t Ol';
    registerGroup.style.display = 'block';
    actionBtn.innerText = 'KayÄ±t Ol';
    toggleModeLink.innerText = 'HesabÄ±n var mÄ±? GiriÅŸ yap';
    note.style.display = 'block';
    forgotLink.style.display = 'block';
    card.classList.remove('big');
  }
});

/* Forgot flow: switch to reset mode (email only) */
forgotLink.addEventListener('click', (e)=>{
  e.preventDefault();
  mode = 'reset';
  formTitle.innerText = 'Åifre SÄ±fÄ±rla';
  registerGroup.style.display = 'none';
  passwordInput.style.display = 'none';
  actionBtn.innerText = 'SÄ±fÄ±rlama E-postasÄ± GÃ¶nder';
  forgotLink.style.display = 'none';
  toggleModeLink.innerText = 'Geri dÃ¶n';
  note.style.display = 'none';
  card.classList.add('big');
});

/* If toggle shows "Geri dÃ¶n" -> reset back to register */
toggleModeLink.addEventListener('click', (e)=>{ /* handled above; ensures "Geri dÃ¶n" also works */
  if(toggleModeLink.innerText === 'Geri dÃ¶n'){
    // reset to register
    mode = 'register';
    formTitle.innerText = 'UNIXSTORM â€” KayÄ±t Ol';
    registerGroup.style.display = 'block';
    passwordInput.style.display = 'block';
    actionBtn.innerText = 'KayÄ±t Ol';
    toggleModeLink.innerText = 'HesabÄ±n var mÄ±? GiriÅŸ yap';
    forgotLink.style.display = 'block';
    note.style.display = 'block';
    card.classList.remove('big');
  }
});

/* ---------- Firebase actions (uses modular functions exposed on window) ---------- */
async function doRegister(email, password, username){
  try{
    const { createUserWithEmailAndPassword } = window._firebaseFns;
    const userCred = await createUserWithEmailAndPassword(window._auth, email, password);
    // send verification:
    await window._firebaseFns.sendEmailVerification(userCred.user);
    // save basic profile to Firestore (username)
    try{
      await window._firebaseFns.setDoc(window._firebaseFns.doc(window._firebaseFns.firestore||window.db || window._firebaseFns.doc, 'users', userCred.user.uid), { username, email, createdAt: new Date().toISOString() });
    }catch(e){
      // if saving fails, ignore; not critical
    }
    showToast('KayÄ±t baÅŸarÄ±lÄ±. E-posta doÄŸrulama gÃ¶nderildi.');
  }catch(err){
    console.error(err);
    showToast(err.message || 'KayÄ±t hatasÄ±');
  }
}

async function doLogin(email, password){
  try{
    const { signInWithEmailAndPassword } = window._firebaseFns;
    const cred = await signInWithEmailAndPassword(window._auth, email, password);
    // check emailVerified
    if(!cred.user.emailVerified){
      showToast('E-posta doÄŸrulanmamÄ±ÅŸ. LÃ¼tfen e-postanÄ± kontrol et.');
      await window._firebaseFns.sendEmailVerification(cred.user);
      return;
    }
    // success -> redirect or show success
    showToast('GiriÅŸ baÅŸarÄ±lÄ±. YÃ¶nlendiriliyorsunuz...');
    // redirect to main site (protected), for now go to home or a placeholder
    setTimeout(()=> { window.location.href = './main.html'; }, 1200);
  }catch(err){
    console.error(err);
    showToast(err.message || 'GiriÅŸ hatasÄ±');
  }
}

async function doReset(email){
  try{
    const { sendPasswordResetEmail } = window._firebaseFns;
    await sendPasswordResetEmail(window._auth, email);
    showToast('Åifre sÄ±fÄ±rlama e-postasÄ± gÃ¶nderildi. Gelen linkle sÄ±fÄ±rlayabilirsin.');
    // go back to register after a sec
    setTimeout(()=> location.reload(), 1500);
  }catch(err){
    console.error(err);
    showToast(err.message || 'SÄ±fÄ±rlama hatasÄ±');
  }
}

/* Hook action button */
actionBtn.addEventListener('click', async ()=>{
  const email = emailInput.value.trim();
  const pw = passwordInput.value;
  const username = usernameInput.value.trim();

  if(mode === 'register'){
    if(!username){ showToast('KullanÄ±cÄ± adÄ± boÅŸ olamaz'); return; }
    if(!email){ showToast('E-posta gir'); return; }
    if(!pw || pw.length < 6){ showToast('Åifre en az 6 karakter'); return; }
    await doRegister(email, pw, username);
  } else if(mode === 'login'){
    if(!email){ showToast('E-posta gir'); return; }
    if(!pw){ showToast('Åifre gir'); return; }
    await doLogin(email, pw);
  } else if(mode === 'reset'){
    if(!email){ showToast('E-posta gir'); return; }
    await doReset(email);
  }
});

/* small defensive: ensure email field visible on login */
(function init(){
  registerGroup.style.display = 'block';
  forgotLink.style.display = 'block';
})();
</script>

</body>
</html>
